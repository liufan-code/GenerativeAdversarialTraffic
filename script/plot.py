# -*- coding: utf-8 -*-

import numpy as np
import matplotlib
matplotlib.use("agg")
import matplotlib.pyplot as plt
from matplotlib import cm

# names = ["Naive\nBayes", "Decision\nTree", "Random\nForest", "Logistic\nRegression"]
# values_dist = [0.567, 0.805, 0.852, 0.761]
# values_len = [0.301, 0.753, 0.786, 0.681]
# values_ipt = [0.588, 0.726, 0.744, 0.673]

# map_vir = cm.get_cmap(name="inferno")
fig = plt.figure(figsize=(8, 6))

# plt.subplot(131)
# plt.ylim(0,1)
# plt.bar(names, values_dist, width=0.3, color=map_vir(values_dist), edgecolor="black")
# plt.axhline(y=0.9, color="red", linestyle="--")
# plt.title("dist")

# plt.subplot(132)
# plt.ylim(0,1)
# plt.bar(names, values_len, width=0.3, color=map_vir(values_len), edgecolor="black")
# plt.axhline(y=0.9, color="red", linestyle="--")
# plt.title("len")

# plt.subplot(133)
# plt.ylim(0,1)
# plt.bar(names, values_ipt, width=0.3, color=map_vir(values_ipt), edgecolor="black")
# plt.axhline(y=0.9, color="red", linestyle="--")
# plt.title("ipt")

# names = ["Naive\nBayes", "Random\nForest", "Logistic\nRegression"]
# marker = ["o-", "^-", "s-"]

# proportion = ["40%", "25%", "15%", "10%", "9%", "8%", "7%", "6%", "5%"]

# dist_nb = [0.802, 0.865, 0.863, 0.867, 0.872, 0.878, 0.884, 0.889, 0.892]
# dist_rf = [0.938, 0.972, 0.980, 0.986, 0.988, 0.989, 0.991, 0.993, 0.994]
# dist_lr = [0.817, 0.836, 0.835, 0.848, 0.849, 0.851, 0.853, 0.854, 0.856]
# dists = [dist_nb, dist_rf, dist_lr]

# len_nb = [0.570, 0.625, 0.655, 0.669, 0.667, 0.664, 0.661, 0.658, 0.656]
# len_rf = [0.968, 0.970, 0.968, 0.968, 0.968, 0.968, 0.967, 0.967, 0.968]
# len_lr = [0.952, 0.957, 0.946, 0.947, 0.944, 0.943, 0.945, 0.946, 0.947]
# lens = [len_nb, len_rf, len_lr]

# ipt_nb = [0.736, 0.708, 0.722, 0.718, 0.718, 0.714, 0.717, 0.719, 0.723]
# ipt_rf = [0.824, 0.832, 0.841, 0.853, 0.856, 0.859, 0.864, 0.866, 0.870]
# ipt_lr = [0.801, 0.789, 0.785, 0.780, 0.786, 0.789, 0.795, 0.798, 0.801]
# ipts = [ipt_nb, ipt_rf, ipt_lr]

# plt.subplot(131)
# plt.xlabel("proportion")
# plt.ylabel("accuracy")
# plt.ylim(0.5, 1)
# plt.axhline(y=0.9, color="red", linestyle="--")
# for i in range(3):
# 	plt.plot(proportion, dists[i], marker="o", linewidth=1, label=names[i])
# plt.title("dist")

# plt.subplot(132)
# plt.xlabel("proportion")
# plt.ylabel("accuracy")
# plt.ylim(0.5, 1)
# plt.axhline(y=0.9, color="red", linestyle="--")
# for i in range(3):
# 	plt.plot(proportion, lens[i], marker="o", linewidth=1, label=names[i])
# plt.title("len")

# plt.subplot(133)
# plt.xlabel("proportion")
# plt.ylabel("accuracy")
# plt.ylim(0.5, 1)
# plt.axhline(y=0.9, color="red", linestyle="--")
# for i in range(3):
# 	plt.plot(proportion, ipts[i], marker="o", linewidth=1, label=names[i])
# plt.title("ipt")

# names = ["Naive\nBayes", "KNN", "Decision\nTree", "Random\nForest", "SVM"]
# marker = [".", "o", "s", "D"]
# color = ["goldenrod", "firebrick", "darkturquoise", "blueviolet"]
# label = ["len tran-matrix", "len seq", "time tran-matrix", "time seq"]

# accuracy = [[52.9, 95.4, 96.3, 96.6, 94.9],
# 			[84.0, 96.2, 98.3, 98.6, 76.9],
# 			[74.7, 77.1, 82.7, 84.1, 81.9],
# 			[63.7, 78.2, 81.9, 84.1, 62.0]]

# FPR = [[0.9, 7.5, 6.8, 6.7, 9.3],
# 	   [16.8, 3.9, 12.8, 2.3, 37.1],
# 	   [51.8, 29.9, 32.2, 29.3, 32.9],
# 	   [92.3, 34.2, 33.3, 26.0, 75.9]]

# precision = [[98.1, 95.6, 96.1, 96.3, 94.7],
# 			 [89.5, 97.7, 98.4, 98.6, 79.6],
# 			 [74.8, 82.2, 82.9, 84.2, 82.4],
# 			 [64.1, 81.0, 82.3, 85.5, 65.4]]

# recall = [[25.7, 97.1, 98.1, 98.4, 97.4],
# 		  [84.6, 96.2, 98.9, 99.1, 85.0],
# 		  [90.2, 81.2, 91.6, 91.9, 90.5],
# 		  [96.7, 85.5, 90.8, 90.0, 84.2]]

# plt.xlabel("Machine Learning Methods")
# plt.ylabel("Value(%)")
# plt.ylim(0, 100)
# for i in range(2,4):
# 	plt.plot(names, accuracy[i], marker=marker[i], linewidth=2, color=color[i], label="accuracy(" + label[i] + ")")
# 	plt.plot(names, FPR[i], marker=marker[i], linestyle="--", linewidth=1.5, color=color[i], label="FPR(" + label[i] + ")")
	# plt.plot(names, precision[i], marker=",", linewidth=1, color="aquamarine")
	# plt.plot(names, recall[i], marker=",", linewidth=1, color="lightskyblue")

# epoch = range(1, 101)

# dnn_loss = [0.6524598065714603, 0.37216327665536547, 0.3272672806767998, 0.2993846625422386, 0.26959663375566684, 0.25071287991813285, 0.23472554106160073, 0.22721690186398355, 0.2175702525804885, 0.2069202545591306, 0.1932187781633871, 0.19038538197052954, 0.18314577252242012, 0.18225818115617515, 0.17551518519596168, 0.16922741033360342, 0.16510488167966378, 0.16827631239481883, 0.1667914635279808, 0.15968766599908102, 0.15896294655201654, 0.1533452337284522, 0.1520513218119971, 0.14949847789348988, 0.14334116475195602, 0.13891050824168885, 0.13931642864716287, 0.12997808152182594, 0.13789663941312288, 0.13246864461940597, 0.13462811139183464, 0.13899926508318072, 0.13657973755380545, 0.12459705537980593, 0.1318623936530388, 0.1306261872242683, 0.13356859482088665, 0.1259706095545053, 0.11655453036582854, 0.12395537029042286, 0.11389182990183615, 0.12776945293219527, 0.11767525172515259, 0.12559944646468574, 0.13494948079340502, 0.11754850747854516, 0.1298328886789019, 0.12336194293904486, 0.1176734222527012, 0.11381809200822429, 0.1164103663430136, 0.1147089190452886, 0.10921624544176092, 0.10816886709305341, 0.1213764450858596, 0.1080127042571311, 0.11257260062693969, 0.1091910899996498, 0.11512115722264567, 0.10372642277955922, 0.10502931266599143, 0.11146562199293966, 0.10082763259888912, 0.10525912383827087, 0.10429201800880299, 0.09449980684434171, 0.10438558420348404, 0.09509590074884697, 0.10272488970692098, 0.10422085671875309, 0.09112714375432517, 0.10505010392337703, 0.10851499237847582, 0.09182613572583202, 0.1028859559548049, 0.09493520369352099, 0.09502627086084144, 0.10102437166667491, 0.09828111687708943, 0.10240337872283395, 0.09453057080890255, 0.08685273117314897, 0.08751245509887093, 0.09716183458549993, 0.11375021385913427, 0.0928022869754751, 0.09183583886781732, 0.09188526349787003, 0.10611300331837066, 0.09114364218982807, 0.08890556705258572, 0.10057591047372372, 0.10060412907853417, 0.08941680625744915, 0.10185894924751696, 0.08499996072718187, 0.09177820396388237, 0.0960120945585852, 0.09598998711783943, 0.09159757634881034]
# dnn_acc = [0.78181326, 0.82929784, 0.8588916, 0.8793382, 0.89104116, 0.8961528, 0.9008609, 0.90482914, 0.907385, 0.9169357, 0.9216438, 0.9220474, 0.9228544, 0.9239978, 0.92843693, 0.9325397, 0.93388486, 0.9317326, 0.9333468, 0.9355663, 0.9344902, 0.93805486, 0.9402072, 0.9401399, 0.9425612, 0.9459241, 0.9459914, 0.9497579, 0.94686574, 0.9503632, 0.94888353, 0.94652945, 0.9486145, 0.95399517, 0.9509685, 0.9498251, 0.9498924, 0.9528518, 0.95614743, 0.9566855, 0.95809793, 0.9523137, 0.9550713, 0.95238096, 0.9497579, 0.9567528, 0.9522464, 0.9548023, 0.9574926, 0.9598467, 0.95816517, 0.95850146, 0.9594431, 0.9614608, 0.95735806, 0.9623352, 0.9595776, 0.960721, 0.958367, 0.96327686, 0.9648238, 0.960721, 0.964622, 0.9637476, 0.96361315, 0.96623623, 0.96240246, 0.96630347, 0.9652946, 0.9644875, 0.96785045, 0.96354586, 0.9645547, 0.9671106, 0.9618644, 0.9652273, 0.9679177, 0.9641512, 0.96583265, 0.96468925, 0.96778315, 0.9689938, 0.9699354, 0.9652946, 0.9614608, 0.968523, 0.96845573, 0.9679177, 0.96394944, 0.96731234, 0.96939737, 0.9648238, 0.96502554, 0.9687248, 0.9672451, 0.9709443, 0.96859026, 0.96549636, 0.96556365, 0.96859026]
# dnn_val_loss = [0.37948439248409327, 0.445737108624299, 0.31860360508007424, 0.28117923245719917, 0.26934998975763536, 0.25671874115808313, 0.24980746926817485, 0.24749447787588952, 0.21161690372788267, 0.2160956259372897, 0.28666159162437654, 0.21401377970075652, 0.19407251092385053, 0.23160950052969104, 0.19689937455056974, 0.2057977660383978, 0.20316905874878224, 0.21430805611745113, 0.20971532417764452, 0.17924620658119167, 0.20739280674100435, 0.18192058502284789, 0.23471230856988068, 0.17707520084834452, 0.20207418092266669, 0.21652372578900125, 0.19232025223826493, 0.21740953475517516, 0.19171081544800828, 0.19011430919344768, 0.19096966221615902, 0.18388652443567094, 0.18443172776989913, 0.18973813178696747, 0.19713717680760198, 0.1924337117948021, 0.18604670264872172, 0.20762335065975765, 0.19524879984779123, 0.1746595528448802, 0.21133037147613054, 0.18251715610512873, 0.2244534927069788, 0.21764275518325923, 0.23864800885684523, 0.21131235222791453, 0.2490692223741189, 0.21199981154653977, 0.2348519489527418, 0.18787840619394625, 0.21144454982928493, 0.18611042757606536, 0.20100040951097783, 0.20213728328980857, 0.23275211584880318, 0.2245444911478234, 0.20786651644083018, 0.21216757038574618, 0.20119387106000294, 0.19918848122356078, 0.19126091945218862, 0.22946252669354328, 0.20209542295088972, 0.2582079432328438, 0.21894458500843295, 0.2309370458412706, 0.2167582415685234, 0.3104522462001179, 0.20418216402945352, 0.20575888591267535, 0.21666559277772343, 0.23571206156524208, 0.21744739301683105, 0.24484778465244608, 0.2376108651508206, 0.2314602744512266, 0.2382805325042778, 0.23442109368509997, 0.2550929724017069, 0.24350144585217695, 0.269185765396091, 0.24042966284352923, 0.24201517135109316, 0.37574823529334006, 0.22242299448282835, 0.23987451472532886, 0.22954333856008308, 0.24672981674582736, 0.2155599809112165, 0.23178633034240803, 0.25018112463495756, 0.24817722599942388, 0.21151762025243884, 0.25177941395469433, 0.24177863877186467, 0.23847579428280172, 0.257257399616529, 0.24963485435370977, 0.26533900349099515, 0.24830483072814435]
# dnn_val_acc = [0.8447673, 0.77132094, 0.85821897, 0.8517622, 0.8870056, 0.9074522, 0.8730159, 0.88162494, 0.90799034, 0.9139091, 0.87355393, 0.9163304, 0.9276298, 0.92305624, 0.92547756, 0.89104116, 0.91606134, 0.9157923, 0.90879744, 0.9362389, 0.9300511, 0.94269574, 0.88216305, 0.9375841, 0.9219801, 0.9273608, 0.92574656, 0.93570083, 0.94511706, 0.94000536, 0.94188863, 0.937046, 0.9416196, 0.94511706, 0.9413506, 0.9416196, 0.94350284, 0.94377184, 0.9424267, 0.94511706, 0.9378531, 0.9491525, 0.9467312, 0.93112725, 0.9300511, 0.9440409, 0.8937315, 0.9464622, 0.93973637, 0.9475383, 0.9424267, 0.9521119, 0.9424267, 0.9486145, 0.9440409, 0.93650794, 0.9440409, 0.93919826, 0.9478074, 0.94700027, 0.9467312, 0.95076674, 0.9534571, 0.9421576, 0.9459241, 0.9483454, 0.95157385, 0.8913102, 0.944848, 0.9467312, 0.9521119, 0.9421576, 0.9472693, 0.9483454, 0.944848, 0.95318806, 0.9475383, 0.9421576, 0.9518429, 0.9491525, 0.9472693, 0.95318806, 0.9537261, 0.91848266, 0.94700027, 0.9456551, 0.9472693, 0.9459241, 0.9518429, 0.9491525, 0.94538605, 0.9432338, 0.94888353, 0.9480764, 0.9478074, 0.95265, 0.9459241, 0.94377184, 0.94538605, 0.9480764]

# cnn_loss = [0.6243850094298057, 0.4439507922338548, 0.3932628522308597, 0.3734890426182606, 0.35997392429414216, 0.3524953853343968, 0.34181986751176674, 0.3295720831894701, 0.31780173289966673, 0.31144440285450575, 0.31543817939544944, 0.30679328701558345, 0.306653334762433, 0.297085973257006, 0.2956234597617784, 0.28166627044643416, 0.2818203692424432, 0.27576864833392567, 0.2733225477972129, 0.269126689068037, 0.2671828407093678, 0.25890145204782905, 0.2633840085090185, 0.25593945018011044, 0.24791351893607538, 0.25562817567770507, 0.24544532217821, 0.24865587973726158, 0.24903140586688374, 0.24731549290944677, 0.2348724708015203, 0.24528656555111686, 0.26654704387069456, 0.2697034399101562, 0.26305553502733187, 0.27237327341396206, 0.26028777067222547, 0.25013416196237914, 0.2442558367353535, 0.2417385987787116, 0.2352194906399556, 0.23594523177957996, 0.22755769004041562, 0.23956969520741087, 0.2547976978479982, 0.2256930617578999, 0.22930285290438848, 0.2285106129872164, 0.21650012611454858, 0.2196747073004178, 0.21557406634032197, 0.21395269079388937, 0.21619821541694856, 0.21221473784393158, 0.21439174235714983, 0.21656897670233846, 0.2078389134363266, 0.2062606136496225, 0.20475005429816368, 0.20651106869579886, 0.199995177164313, 0.20084003312976764, 0.20052137531020411, 0.19663187693619089, 0.1924273398451012, 0.19641519899592544, 0.19196090783837672, 0.19650991978677515, 0.1900616487303239, 0.19449908844750793, 0.1947098461022104, 0.19265180718046476, 0.18615979264007482, 0.187330105050823, 0.18311244377128244, 0.18369845183451458, 0.18195111160851837, 0.18843980551212985, 0.1845304059753691, 0.18311555313263644, 0.1808287812632909, 0.18205487903859993, 0.17912188596496814, 0.17776288160262993, 0.1838047128363157, 0.18472222777528005, 0.17773840686755857, 0.17905783381955515, 0.18690888313533985, 0.18333884212595578, 0.18258278027832317, 0.17939239352834274, 0.18373399546516736, 0.17599441100464158, 0.1839846362867702, 0.178125408176911, 0.18023215463640055, 0.1750076752725286, 0.1773642196182441, 0.1830910010256308]
# cnn_acc = [0.7415254, 0.78874093, 0.8283562, 0.8361582, 0.84086627, 0.84550714, 0.848332, 0.8531746, 0.85855526, 0.8557304, 0.856134, 0.8570756, 0.8568066, 0.8614474, 0.86279255, 0.87012374, 0.8700565, 0.8750336, 0.87644607, 0.8770514, 0.87785846, 0.8846516, 0.8831047, 0.8870729, 0.8900323, 0.8888889, 0.89400053, 0.8895615, 0.889696, 0.8934625, 0.8984396, 0.8911757, 0.87900186, 0.86904764, 0.8685768, 0.8635324, 0.8719397, 0.8761098, 0.88572776, 0.88788, 0.89030135, 0.89137745, 0.8950767, 0.88989776, 0.88101965, 0.89379877, 0.8935297, 0.8970944, 0.905569, 0.90456015, 0.90617436, 0.9083266, 0.9042911, 0.9085956, 0.90913373, 0.905838, 0.9102771, 0.9105461, 0.9135728, 0.9117568, 0.9155905, 0.9159268, 0.9140436, 0.9174065, 0.9209712, 0.9194915, 0.9223164, 0.92043316, 0.92467046, 0.91955876, 0.919357, 0.92124027, 0.92581385, 0.9242669, 0.923258, 0.92688996, 0.92500675, 0.9255448, 0.9266882, 0.92688996, 0.92574656, 0.9263519, 0.9273608, 0.928975, 0.92527574, 0.92446864, 0.9256793, 0.92769706, 0.9244014, 0.9279661, 0.92655367, 0.9293785, 0.928975, 0.9294458, 0.927428, 0.9286387, 0.9267554, 0.93106, 0.9304547, 0.9286387]
# cnn_val_loss = [0.4281591157503336, 0.3734963868682282, 0.33720185249474605, 0.3426209822405337, 0.3194622840248259, 0.3229974937240122, 0.31220299065642243, 0.2832367316606002, 0.3036484971205522, 0.28216455166045457, 0.3323250764523394, 0.3267679978177084, 0.2947784091997666, 0.29907669212377486, 0.28176857438464625, 0.3090091276255416, 0.2850562556195009, 0.2798361336335816, 0.27903641314156313, 0.2671593111835246, 0.2792811124177912, 0.2623639915530355, 0.28550963919586736, 0.27030602150429056, 0.2581369216391756, 0.29447440119930773, 0.25878334075076176, 0.2579764719969296, 0.25105093693962527, 0.25477309309332996, 0.2647730621289014, 0.24386093423135313, 0.24683166015266828, 0.23754428854858103, 0.22345718837230155, 0.276146883838017, 0.2809648641097247, 0.26165113735814743, 0.25773158838247334, 0.2503407847498064, 0.2575942885540556, 0.23562259680246006, 0.23624157992171319, 0.29983129030615213, 0.2918879464789844, 0.27732851101100076, 0.24164825366779397, 0.22511741190643633, 0.2507000186645699, 0.23093789764187622, 0.24357711532390466, 0.24109651568654664, 0.2183423724896426, 0.24121721730915038, 0.26802762936753616, 0.2658546695459152, 0.22868857583452495, 0.27078678111956905, 0.24227438707537058, 0.21529908872337022, 0.22739590877626478, 0.23131584428012258, 0.1985171100113191, 0.22529361595269137, 0.19085706095718588, 0.2095413778838144, 0.20924109463445403, 0.20770710343302082, 0.19136187813640892, 0.2140560953013192, 0.22876097108163532, 0.19845983673479406, 0.23952650248539328, 0.22043691237976, 0.2395933715885674, 0.2656559865718283, 0.2301235742584364, 0.24270639188120627, 0.22800406827251854, 0.25679806752778334, 0.24159428897021373, 0.24183315141710313, 0.2522623755973868, 0.23725355988809874, 0.24962791083904246, 0.2312141297896735, 0.2356106880105148, 0.2435296013057312, 0.23750321491089502, 0.24422674252280055, 0.2173202246776312, 0.23582872742361558, 0.26311349462871114, 0.24807037525821074, 0.29194093540407073, 0.25785888530783013, 0.25905455559700574, 0.2507214643941119, 0.25158718462160495, 0.25513279715035275]
# cnn_val_acc = [0.75060534, 0.8514931, 0.8603713, 0.8463815, 0.85795, 0.86198545, 0.8657519, 0.86978745, 0.866559, 0.86090934, 0.85795, 0.8646758, 0.86198545, 0.86871135, 0.8711326, 0.8708636, 0.87328494, 0.8684423, 0.87785846, 0.8746301, 0.8652139, 0.8794727, 0.8853915, 0.86817324, 0.86413777, 0.874092, 0.87678236, 0.866021, 0.8773204, 0.8789346, 0.8754372, 0.8730159, 0.87328494, 0.87758946, 0.9171375, 0.87597525, 0.8730159, 0.8746301, 0.8748991, 0.8802798, 0.87436104, 0.8872747, 0.8727468, 0.8754372, 0.88216305, 0.88297015, 0.8931934, 0.88673663, 0.88458437, 0.8870056, 0.8880818, 0.88942695, 0.8907721, 0.8958838, 0.8931934, 0.8872747, 0.8888889, 0.8789346, 0.8942696, 0.92843693, 0.89642185, 0.89803606, 0.8996503, 0.90099543, 0.9459241, 0.89884317, 0.8985741, 0.89911216, 0.9031477, 0.9012645, 0.8942696, 0.9012645, 0.90260965, 0.8915792, 0.8966909, 0.9004574, 0.90207154, 0.90287864, 0.90287864, 0.89642185, 0.9047619, 0.8958838, 0.89830506, 0.90449286, 0.89803606, 0.8993812, 0.8999193, 0.8870056, 0.90610707, 0.897767, 0.8966909, 0.89400053, 0.8942696, 0.89911216, 0.8810869, 0.8945386, 0.897767, 0.889965, 0.8966909, 0.89561474]

# rnn_loss = [0.34315290275579313, 0.2707466427181673, 0.2334358719179298, 0.2058181220999818, 0.18101196262819097, 0.1683929475280663, 0.16678684239869826, 0.15858346226737643, 0.1554746047711666, 0.1411054253473954, 0.139156030545616, 0.13438843069613113, 0.13399884622355632, 0.13247644444133305, 0.12536494148056276, 0.129522991357727, 0.13342271841769823, 0.12034510635353178, 0.12306284440234344, 0.12152580688122479, 0.12696770822791192, 0.12856373205888222, 0.11867736042780365, 0.11738632901565177, 0.11813410728260823, 0.12000146522661503, 0.12221525862619065, 0.1200117998773882, 0.11837832560520474, 0.12440831055054138, 0.11756933129181846, 0.11730259120932116, 0.11888654364830693, 0.12117154962406512, 0.11844006360193801, 0.11433755994639351, 0.11044476536553095, 0.11071037968386638, 0.11008644508372542, 0.12903930680520126, 0.11300903007554486, 0.12015680720195783, 0.10769290082703625, 0.10719432244200099, 0.10906769042036113, 0.1054981446472684, 0.11395715935108644, 0.10861037225272824, 0.11138443266702297, 0.10416896559347148, 0.10156718338964989, 0.10544912027305843, 0.11047938118122752, 0.10799650798025819, 0.11565633867551589, 0.11386209773513613, 0.12170319000108958, 0.11696991450185863, 0.11256298729865483, 0.1180389689543165, 0.10516122486892078, 0.11507552079475548, 0.12182966328344043, 0.12471341222706547, 0.11170834932791483, 0.11426666276064647, 0.11768804703602848, 0.11386777575405649, 0.11476919857846743, 0.11141591648549144, 0.10765173989295497, 0.1140984466507628, 0.10770152181301508, 0.11274525715989799, 0.11198716415498253, 0.1174317675905504, 0.1081856392014031, 0.11414354042064138, 0.11743258864586015, 0.13841415862927406, 0.1276081743770907, 0.1194958362344002, 0.11768201473368221, 0.12159370934711716, 0.12037888842981628, 0.11685669122889933, 0.11880152387357096, 0.11496867752942927, 0.12530729632984014, 0.11847809089331685, 0.11447026054864713, 0.11352829818902219, 0.11484628348912716, 0.11110874871668983, 0.10712334644768506, 0.10823202472170607, 0.113059680095859, 0.12548195419082395, 0.12656204674477126, 0.11875179797743705]
# rnn_acc = [0.842615, 0.8750336, 0.90025556, 0.91646487, 0.9268227, 0.9346247, 0.9332795, 0.9375168, 0.93987083, 0.9459914, 0.94626045, 0.94700027, 0.9484127, 0.94700027, 0.95265, 0.95157385, 0.9518429, 0.9539279, 0.9533226, 0.95305353, 0.9503632, 0.9502287, 0.954735, 0.9532553, 0.9556766, 0.9534571, 0.9539279, 0.95318806, 0.9533226, 0.952919, 0.95735806, 0.9552058, 0.95238096, 0.954466, 0.9546005, 0.9575599, 0.95776165, 0.9564165, 0.95816517, 0.9510358, 0.95809793, 0.9539279, 0.95998114, 0.9598467, 0.958636, 0.95776165, 0.95547485, 0.95930856, 0.9579634, 0.96004844, 0.96132636, 0.9609901, 0.9572236, 0.9570218, 0.9553403, 0.95776165, 0.9525827, 0.9566855, 0.958367, 0.9560802, 0.9603847, 0.95655096, 0.9524482, 0.950834, 0.9570218, 0.9575599, 0.95433146, 0.95655096, 0.9563492, 0.9572236, 0.95998114, 0.9571563, 0.95937586, 0.95816517, 0.9576271, 0.95742536, 0.9605865, 0.95661825, 0.95513856, 0.944848, 0.9478746, 0.95318806, 0.95513856, 0.954735, 0.95419693, 0.95614743, 0.9545332, 0.9557439, 0.954466, 0.9537261, 0.9552731, 0.9572236, 0.95655096, 0.95682, 0.95769435, 0.9576271, 0.95742536, 0.9541297, 0.9541297, 0.95540756]
# rnn_val_loss = [0.3018887322581453, 0.2543567746741367, 0.20474323094139696, 0.1367850338647787, 0.18580079277717268, 0.1518018675433361, 0.21519360452176808, 0.1514736530915973, 0.12854485266072987, 0.12698937782039077, 0.17820845738370025, 0.13167906197112175, 0.14709226802825318, 0.14129202457168408, 0.13906436837770653, 0.14443655085958138, 0.13453225138401004, 0.12400466709465133, 0.12322320490434088, 0.1260065758199438, 0.12098012244910651, 0.13376488309090004, 0.12349404661871347, 0.12931498580664608, 0.14344278440773406, 0.17434336734298725, 0.12585298477138102, 0.1340948905032113, 0.11656325406532456, 0.14624874260429896, 0.1417158915274665, 0.12556727194468564, 0.2457930006894624, 0.17104225938767395, 0.1288778587267753, 0.10255422506342099, 0.26585065540455466, 0.20865383860899422, 0.11670809396298816, 0.15573883004875427, 0.1143631617179582, 0.11917634777832983, 0.12957662501228828, 0.11776385758345746, 0.12914248593582528, 0.16020968767198218, 0.12258534323056282, 0.13365132136950417, 0.1267799081387064, 0.12747109020597389, 0.11241714702605929, 0.11334781087774615, 0.18704915884756934, 0.11562097891473645, 0.1370369112607666, 0.12474926989545601, 0.14266749044826652, 0.11300533141901745, 0.10622228225024118, 0.13566628326194594, 0.13066382285053166, 0.13402438839661487, 0.13063786024333474, 0.125839363446598, 0.12067700675188822, 0.12788461403656157, 0.11825945513648173, 0.1365638743506738, 0.11799144215845744, 0.11748367102196822, 0.12027464659805898, 0.1147068982749961, 0.11978364045756028, 0.13509059310228008, 0.13675381693130126, 0.1109468455989899, 0.12272066348060696, 0.14608624519493138, 0.10733056609424366, 0.16616737808509038, 0.11501907886281301, 0.1861566125410505, 0.11606662044337208, 0.11990131240188755, 0.11461620517465931, 0.13504670563366647, 0.12324267389232237, 0.12172286026956519, 0.12038049473606886, 0.1502436231310638, 0.12453423439604494, 0.11637806252671372, 0.11295211684577144, 0.11219849348427036, 0.1101927194550918, 0.11722929121358663, 0.12593330316474063, 0.13575718479964133, 0.2047967332609966, 0.11233895738930601]
# rnn_val_acc = [0.8294323, 0.913102, 0.921711, 0.9483454, 0.928975, 0.94000536, 0.88673663, 0.93381757, 0.9553403, 0.9556094, 0.93381757, 0.95157385, 0.94619316, 0.9480764, 0.95265, 0.94700027, 0.9483454, 0.9548023, 0.9510358, 0.9553403, 0.9582997, 0.952919, 0.95614743, 0.9518429, 0.9480764, 0.95399517, 0.9615281, 0.94969064, 0.9510358, 0.9534571, 0.95076674, 0.9504977, 0.9015335, 0.9359699, 0.95265, 0.9609901, 0.91068065, 0.9120258, 0.952919, 0.94081247, 0.9564165, 0.9537261, 0.9574926, 0.9556094, 0.94969064, 0.95695454, 0.9572236, 0.9502287, 0.95614743, 0.95695454, 0.95399517, 0.9615281, 0.9394673, 0.9556094, 0.9480764, 0.9572236, 0.94457895, 0.95964485, 0.96421844, 0.9521119, 0.95399517, 0.9615281, 0.95399517, 0.95318806, 0.9558784, 0.9553403, 0.95856875, 0.95803064, 0.9574926, 0.9545332, 0.95399517, 0.95856875, 0.95803064, 0.9521119, 0.95426416, 0.9591068, 0.95883775, 0.94430995, 0.9644875, 0.905569, 0.95614743, 0.92493945, 0.9566855, 0.9534571, 0.9599139, 0.95238096, 0.95238096, 0.9566855, 0.95318806, 0.9421576, 0.95399517, 0.9534571, 0.9558784, 0.96125907, 0.95883775, 0.9548023, 0.94511706, 0.9494216, 0.90287864, 0.9617972]

# lstm_loss = [0.2954547575772418, 0.23469037504629692, 0.20667587182433703, 0.1909059343869826, 0.17340754596919888, 0.1650198759919021, 0.1582816848433648, 0.15903700154662065, 0.14649479311708244, 0.1357228009781645, 0.1422992492958308, 0.12760918499500498, 0.12164067588673887, 0.11603955866268843, 0.11318952366654586, 0.11067997634121214, 0.10740059873915783, 0.1063819015117997, 0.10105621133599493, 0.09866121320170695, 0.09746333345909143, 0.09171891402899678, 0.08753096839069281, 0.08971788522695688, 0.08397330047395095, 0.08542276202280848, 0.07955367112275938, 0.08265920490039504, 0.07970341625883985, 0.08006816666255329, 0.0808648290469346, 0.0750226042701825, 0.07594874999950695, 0.07677853740811877, 0.07430186034873015, 0.07371071057812202, 0.07569445017380713, 0.07464874667495229, 0.07274560552337017, 0.07049906366205438, 0.07406530597863305, 0.06872308036682785, 0.07166569494825976, 0.07224736866081559, 0.07015162438504, 0.0723980125769565, 0.06590112154747246, 0.06709501334004513, 0.06549385749022854, 0.06750404362273993, 0.06465150878611473, 0.06368110546246392, 0.06459581488245128, 0.06564080877453068, 0.0674310415782566, 0.06601598965877781, 0.06685111420267287, 0.06513944397119714, 0.06118762824749652, 0.06507848206091821, 0.06313123233293258, 0.06301161486943364, 0.06257143446068533, 0.062405701317357884, 0.059737578541780065, 0.06426186489892742, 0.0629384569684338, 0.061543524474880734, 0.059069723905455535, 0.06857690614455735, 0.06647472398892172, 0.06513476331331405, 0.0647709905791287, 0.06832181739683879, 0.06510862170805429, 0.06255037245890745, 0.061425855497311964, 0.060899732837502094, 0.06485059643855816, 0.06296784292791517, 0.0657626191264493, 0.06296312401430365, 0.06582733170904334, 0.06456334083837166, 0.06094235494914636, 0.05909790317407056, 0.06596294208982546, 0.06179213783952924, 0.06152232666966576, 0.060440388559849866, 0.0605807801083939, 0.059483187900572256, 0.05854604768723135, 0.06155319945846767, 0.06206109236159385, 0.061233653668618646, 0.06396021155681449, 0.061269163371393, 0.06175150411965324, 0.061321410872350365]
# lstm_acc = [0.86595374, 0.9015335, 0.9147162, 0.92305624, 0.93388486, 0.9354991, 0.9405435, 0.93926555, 0.94659674, 0.9521792, 0.9478074, 0.95628196, 0.95816517, 0.96051925, 0.96213347, 0.9622007, 0.9651601, 0.96341133, 0.9668415, 0.9675141, 0.96744686, 0.9708098, 0.9710116, 0.97168416, 0.9722222, 0.9732984, 0.97390366, 0.9732311, 0.9740382, 0.9737019, 0.97471076, 0.97504705, 0.97558516, 0.9752489, 0.9756524, 0.97625774, 0.97672856, 0.9767958, 0.9769303, 0.9782755, 0.9765268, 0.9788136, 0.9771994, 0.97787195, 0.9790826, 0.97699755, 0.9796879, 0.9787463, 0.9794189, 0.97867906, 0.97935164, 0.97935164, 0.9779392, 0.97962064, 0.9787463, 0.9790826, 0.9788808, 0.97962064, 0.9803605, 0.98049504, 0.98049504, 0.98143667, 0.9808313, 0.97928435, 0.98170567, 0.9808313, 0.98143667, 0.9808313, 0.9813694, 0.9779392, 0.97841, 0.97962064, 0.97975516, 0.9776029, 0.9796879, 0.9800242, 0.98062956, 0.9813694, 0.9803605, 0.9803605, 0.9792171, 0.98056227, 0.9788136, 0.9800242, 0.98123485, 0.98163843, 0.9791499, 0.98015875, 0.98056227, 0.9810331, 0.98130214, 0.98130214, 0.9819074, 0.98130214, 0.9802933, 0.9808313, 0.98123485, 0.9811003, 0.98123485, 0.98089856]
# lstm_val_loss = [0.22844633788776422, 0.297629035723676, 0.20458115006899494, 0.22139287465581464, 0.21476296228821443, 0.13282354869212046, 0.1887574880044403, 0.11525301949113792, 0.1911768613201269, 0.21432734636917114, 0.10761171952691775, 0.12909074332028875, 0.10111359447338046, 0.12303670677001884, 0.10828868695854227, 0.10315201229262744, 0.10739690689222207, 0.10125968292997466, 0.08621739941847831, 0.09132649881912074, 0.08804056546050741, 0.0884962518074827, 0.11268872283208681, 0.08380294469743166, 0.12344038425545106, 0.09766198251845416, 0.07554475717920031, 0.07800165922971047, 0.13390329361457015, 0.08095705775403234, 0.07925279545834508, 0.08641504984296897, 0.08919258256820435, 0.1117219836369682, 0.08678454299474159, 0.0804102498194103, 0.08495561207925516, 0.10015091353680118, 0.30415892712360976, 0.07627806732070752, 0.07987312981991646, 0.07573805645472534, 0.07212154609924155, 0.0770925985496889, 0.07439780640554906, 0.08194705090999908, 0.07922871544218517, 0.09969399090308094, 0.16405782210100658, 0.08015991092785063, 0.07673025427710387, 0.11335985427524395, 0.07443308752488154, 0.11211604757381281, 0.06968957944759357, 0.11329830888501412, 0.07783804970918956, 0.08254762071257225, 0.08540803781991942, 0.08110291363329661, 0.08051771079063544, 0.06956056128822283, 0.07510134385623597, 0.0829708613842407, 0.0806639854568098, 0.08675860479197953, 0.07715607849271697, 0.09783799230740706, 0.08079468584207296, 0.08053331171032888, 0.08168497817983707, 0.08124177722723386, 0.12174229380089108, 0.0850099799816314, 0.08894470256242379, 0.11663359269110914, 0.11484549492587558, 0.08785962810482302, 0.09390737609810003, 0.09000272774391872, 0.09321817659459986, 0.08957229814130611, 0.09033975977613973, 0.07916210741125386, 0.08910679905308284, 0.08332155842909313, 0.08138250248275651, 0.08013734146998983, 0.08270252672584569, 0.07760182518425819, 0.08379247158220579, 0.08852226629488437, 0.08300255188810643, 0.0990861057115176, 0.08564947897286217, 0.09519690778023766, 0.08511296856019898, 0.09521421391410688, 0.08417606256706282, 0.08394293272143688]
# lstm_val_acc = [0.9252085, 0.8800108, 0.8937315, 0.8888889, 0.90368575, 0.9566855, 0.91068065, 0.96583265, 0.9424267, 0.8934625, 0.96421844, 0.9722895, 0.9698682, 0.9652946, 0.968792, 0.9706753, 0.97282755, 0.96475655, 0.97282755, 0.9752489, 0.97444177, 0.976056, 0.97282755, 0.9752489, 0.9620662, 0.97202045, 0.9787463, 0.9779392, 0.96125907, 0.9771321, 0.97820824, 0.97820824, 0.97444177, 0.9582997, 0.9771321, 0.976056, 0.97444177, 0.9722895, 0.92224914, 0.97982246, 0.976056, 0.97847724, 0.97928435, 0.97847724, 0.98062956, 0.9795534, 0.97901535, 0.9752489, 0.9085284, 0.9787463, 0.97982246, 0.9582997, 0.9795534, 0.97202045, 0.9811676, 0.9615281, 0.9768631, 0.98009145, 0.976056, 0.9795534, 0.9779392, 0.98009145, 0.97982246, 0.97901535, 0.9803605, 0.97551787, 0.9787463, 0.9741727, 0.97901535, 0.97847724, 0.9779392, 0.9771321, 0.96394944, 0.97740114, 0.97820824, 0.96933013, 0.9698682, 0.9776702, 0.9752489, 0.97740114, 0.9752489, 0.9730966, 0.9752489, 0.9776702, 0.97820824, 0.976056, 0.9771321, 0.97847724, 0.9779392, 0.9803605, 0.9776702, 0.9768631, 0.9787463, 0.9714824, 0.9787463, 0.9749798, 0.97901535, 0.976325, 0.97901535, 0.97982246]

# gru_loss = [0.28288824443963706, 0.20302795799675089, 0.16254917563475169, 0.13982673062593895, 0.1319169251093897, 0.12239253006589629, 0.11421928500001441, 0.11170684429046437, 0.10179525722031935, 0.09589552089024735, 0.09365411791191275, 0.0907279651661278, 0.08717890419731182, 0.08717134776771998, 0.08199181374572598, 0.08535160824554008, 0.07872549448546172, 0.07488739402701125, 0.07841804242634132, 0.07434280639168432, 0.07574806930827398, 0.07393985852122584, 0.07074978216434108, 0.07273883475587052, 0.06634310306408056, 0.06865301552733002, 0.06765236368024873, 0.06810148366750612, 0.06702440897882775, 0.06608085842716803, 0.06609840212342973, 0.06859472281655198, 0.06502057714752336, 0.06724718267687256, 0.06507103092339439, 0.06812362564460946, 0.0672098164876233, 0.06506268187136136, 0.06376930806658163, 0.0638604260658678, 0.06350415945197171, 0.06752750239619258, 0.06292585392269229, 0.06630626890935752, 0.062790877323412, 0.0643039301405419, 0.06207021477846201, 0.06284952053263029, 0.06180679789375497, 0.06035460703919812, 0.06327702947363573, 0.06420339681244465, 0.06211365545061406, 0.060810065495773835, 0.060286990748005545, 0.06172253652136895, 0.06458246819683738, 0.06824353715150677, 0.06194610912734274, 0.06272510973837994, 0.06084644788081157, 0.061211802300082295, 0.06295568654435205, 0.06166120519924719, 0.0586129052587741, 0.05997069231993054, 0.06374552014532765, 0.06212498583680684, 0.06167903658345127, 0.06192917946314794, 0.06184539291863614, 0.0596085992878336, 0.05889096154524667, 0.059136930247969205, 0.05857796984859876, 0.06398209824874113, 0.06322892550451699, 0.06363816877629358, 0.06282373165398814, 0.05931074432900914, 0.05976327089107359, 0.06078992376500755, 0.06209021183216876, 0.0601362933308968, 0.06125696945229792, 0.0610558073782909, 0.06000120839132745, 0.06788246177338847, 0.059083276235446874, 0.062487661119932314, 0.06310678044517462, 0.061532280912782164, 0.06090437903864229, 0.06050998077794628, 0.06165632492353885, 0.05593162588797082, 0.05824924397918343, 0.06064272584953742, 0.060639985875471605, 0.06534356667018373]
# gru_acc = [0.87059456, 0.9165994, 0.9364407, 0.948749, 0.9525155, 0.9560802, 0.9605865, 0.9610573, 0.9657654, 0.96825397, 0.9683885, 0.97040623, 0.970339, 0.9696664, 0.9717514, 0.9722222, 0.9751816, 0.97558516, 0.97424, 0.97706485, 0.9757869, 0.97659403, 0.9772666, 0.9764595, 0.97841, 0.97820824, 0.9783428, 0.9791499, 0.9791499, 0.9796879, 0.97975516, 0.9788808, 0.9800242, 0.9788136, 0.9795534, 0.9791499, 0.97894806, 0.9798897, 0.97982246, 0.9806968, 0.9808313, 0.9798897, 0.98096585, 0.9794189, 0.98056227, 0.98042774, 0.98056227, 0.9802933, 0.98096585, 0.9815039, 0.98096585, 0.97928435, 0.9815039, 0.9815039, 0.98096585, 0.9808313, 0.97928435, 0.9792171, 0.9811676, 0.98096585, 0.98143667, 0.98062956, 0.9810331, 0.9806968, 0.9822437, 0.98130214, 0.9796879, 0.980226, 0.9811003, 0.98015875, 0.98089856, 0.98089856, 0.982311, 0.9818402, 0.98210925, 0.9806968, 0.98042774, 0.97948617, 0.9803605, 0.9806968, 0.98089856, 0.98244554, 0.98015875, 0.98157114, 0.98042774, 0.98015875, 0.98143667, 0.97935164, 0.9815039, 0.9819747, 0.98096585, 0.9813694, 0.9803605, 0.9819747, 0.9811676, 0.98258007, 0.98157114, 0.98143667, 0.9810331, 0.9790826]
# gru_val_loss = [0.2585305985918217, 0.1776329568831036, 0.1499661627915363, 0.1625435745009322, 0.12623324536061717, 0.12281035039877583, 0.124710917784533, 0.11792621535006265, 0.09814903173943441, 0.10450031383091848, 0.09262110997529593, 0.11800264531983534, 0.08961806598001425, 0.0889742108598604, 0.11859436875912277, 0.0926741257656059, 0.08404344826072799, 0.13967879555111198, 0.10112439948446068, 0.08265720731194161, 0.09460538592217613, 0.11349065194744792, 0.08676088450214443, 0.08845067790536301, 0.08823952573119295, 0.08480260492434522, 0.09474362873436945, 0.11286867512547868, 0.09402410919034644, 0.08337243767051823, 0.09890327152523233, 0.08603383021610585, 0.10868279177498574, 0.08264448810198397, 0.08840135000856583, 0.08114383881498215, 0.08132372632169711, 0.07780342638246536, 0.08200829338837583, 0.10600333336068235, 0.08784356900448977, 0.07759190609371443, 0.107371190238059, 0.09628490723052155, 0.09198910236345613, 0.08671371312548885, 0.08962441157130688, 0.11243151294123627, 0.09217769568542984, 0.08267871855314894, 0.08800956956505523, 0.0989615228845176, 0.1101139313457416, 0.0757918085262504, 0.08541703170299718, 0.11309261926351366, 0.08761427973396825, 0.08064527131009717, 0.1018343049201504, 0.08067465346694426, 0.09065380933117508, 0.08436235465998326, 0.0927258307712575, 0.08414821124883438, 0.08003469455244562, 0.09625347002259314, 0.0867673168169324, 0.2706530520237455, 0.08833034544504671, 0.08914933554810127, 0.08541803683144514, 0.08752239011664055, 0.09905155498648695, 0.08351933587826578, 0.08289931254009902, 0.0982458581639324, 0.07917568810611868, 0.08711587325718684, 0.11318344896359087, 0.0882244370545754, 0.08027813223937016, 0.08209009083836794, 0.0863369493665089, 0.07561095301658195, 0.07972214532299993, 0.10122222149078648, 0.06453059775101355, 0.08371318578053609, 0.0875422873962465, 0.12749707808992194, 0.08153013398676393, 0.07477024812797545, 0.09053934140867266, 0.094567816858354, 0.07712688933950712, 0.07748175728607613, 0.08950656328178924, 0.07672431862283922, 0.07959395060405929, 0.07692518495930269]
# gru_val_acc = [0.87328494, 0.93032014, 0.9467312, 0.94081247, 0.9550713, 0.9574926, 0.936777, 0.96394944, 0.9617972, 0.96475655, 0.96825397, 0.9599139, 0.96825397, 0.96583265, 0.95238096, 0.96744686, 0.97363466, 0.952919, 0.9701372, 0.97444177, 0.9695991, 0.96314234, 0.97363466, 0.97390366, 0.97444177, 0.97444177, 0.97282755, 0.9663707, 0.97363466, 0.976325, 0.97282755, 0.97282755, 0.9558784, 0.9757869, 0.9757869, 0.9749798, 0.97471076, 0.9768631, 0.97471076, 0.96744686, 0.9757869, 0.9771321, 0.9722895, 0.9725585, 0.9752489, 0.97202045, 0.97471076, 0.95399517, 0.97444177, 0.97659403, 0.9722895, 0.9706753, 0.96556365, 0.9752489, 0.97901535, 0.9771321, 0.9752489, 0.97659403, 0.97202045, 0.9717514, 0.9714824, 0.9771321, 0.9730966, 0.9768631, 0.97551787, 0.97282755, 0.97471076, 0.9281679, 0.9768631, 0.97363466, 0.97471076, 0.97471076, 0.9749798, 0.97820824, 0.97659403, 0.9701372, 0.97551787, 0.97444177, 0.9695991, 0.97659403, 0.97740114, 0.97471076, 0.97847724, 0.97928435, 0.97901535, 0.97390366, 0.97847724, 0.976056, 0.97471076, 0.9620662, 0.97551787, 0.9776702, 0.97659403, 0.96744686, 0.97659403, 0.9757869, 0.97471076, 0.97820824, 0.9771321, 0.9776702]

# ax1 = fig.add_subplot(111)
# ax1.set_xlabel("Epoch")
# ax1.set_ylabel("Acc(%)")
# ax1.set_ylim(80, 100)
# plt.plot(epoch, np.array(gru_acc)*100, marker=".", linewidth=1.5, color="maroon", label="acc(GRU)")
# plt.plot(epoch, np.array(gru_val_acc)*100, marker=".", linewidth=1.5, color="darkcyan", label="val_acc(GRU)")
# plt.legend(loc="upper left")

# ax2 = ax1.twinx()
# ax2.set_ylabel("Loss")
# ax2.set_ylim(0, 0.8)
# plt.plot(epoch, gru_loss, marker="x", linewidth=1.5, color="lightcoral", label="loss(GRU)")
# plt.plot(epoch, gru_val_loss, marker="x", linewidth=1.5, color="paleturquoise", label="val_loss(GRU)")
# plt.legend(loc="upper right")

# EPS = range(1, 36)
# fgsm_dnn = [8.43, 12.29, 14.00, 14.86, 15.57, 17.71, 19.29, 20.57, 21.57, 21.71,
# 			22.43, 23.43, 23.57, 24.14, 24.57, 24.71, 24.29, 25.00, 24.57, 24.86, 
# 			26.29, 27.14, 26.86, 26.71, 26.71]
# fgsm_cnn = [20.43, 23.71, 26.71, 29.00, 32.29, 32.71, 33.43, 35.14, 35.57, 38.57,
# 			39.43, 41.43, 40.86, 40.43, 40.71, 41.29, 40.86, 41.57, 41.86, 42.43,
# 			42.29, 43.86, 69.71, 69.29, 69.29]
# fgsm_lstm = [9.86, 12.29, 14.86, 18.57, 20.43, 25.29, 54.71, 59.71, 64.57, 68.57,
# 			 72.14, 76.00, 76.43, 76.57, 78.14, 78.29, 78.57, 79.29, 79.43, 79.86,
# 			 80.14, 81.14, 81.86, 82.14, 82.14]
# bim_dnn = [9.71, 12.14, 14.43, 38.86, 40.86, 44.43, 48.43, 50.14, 52.00, 56.57,
# 		   59.29, 61.43, 63.71, 64.86, 65.57, 67.86, 68.71, 70.43, 71.14, 72.71,
# 		   74.29, 74.86, 76.57, 77.00, 77.43]
# bim_cnn = [20.86, 22.14, 27.71, 31.86, 34.00, 37.00, 40.00, 44.86, 46.14, 51.00,
# 		   52.86, 78.86, 80.57, 81.00, 81.71, 83.57, 84.00, 84.14, 84.29, 84.57,
# 		   84.71, 85.00, 84.71, 84.57, 84.71]
# bim_lstm = [10.43, 15.57, 18.00, 22.71, 26.29, 34.14, 65.43, 72.14, 79.14, 81.71,
# 			82.57, 84.29, 85.71, 88.43, 89.14, 89.14, 89.71, 90.57, 91.14, 91.00,
# 			91.29, 91.57, 92.00, 92.14, 92.71]
# mim_dnn = [9.29, 11.86, 36.43, 38.71, 41.57, 45.71, 49.29, 52.14, 55.86, 59.14,
# 		   61.86, 65.00, 67.57, 70.86, 73.29, 74.29, 77.14, 80.00, 80.29, 83.57,
# 		   85.71, 86.57, 88.14, 88.14, 88.57]
# mim_cnn = [21.43, 24.29, 27.43, 32.29, 35.57, 39.14, 42.29, 45.43, 49.86, 54.86,
# 		   56.29, 83.71, 84.57, 85.14, 85.71, 87.71, 88.00, 87.71, 87.86, 88.29,
# 		   87.57, 87.86, 88.00, 87.86, 87.57]
# mim_lstm = [11.00, 15.43, 18.57, 23.00, 27.00, 35.71, 69.86, 75.71, 82.71, 88.43,
# 			88.29, 92.86, 93.71, 94.14, 94.43, 95.29, 96.14, 96.00, 97.86, 97.43,
# 			96.86, 98.00, 97.86, 98.14, 97.71]

# fgsm_dnn = [7.35, 9.34, 34.25, 35.24, 37.11, 38.61, 39.98, 39.6, 40.6, 40.35,
# 			40.6, 41.84, 42.47, 42.59, 43.34, 43.96, 43.84, 44.83, 45.21, 45.21,
# 			45.33, 45.45, 24.41, 24.03, 24.91]

# fgsm_cnn = [3.4, 3.6, 4.22, 4.83, 5.15, 5.56, 5.77, 5.77, 6.18, 7.0,
# 			7.21, 10.61, 10.92, 11.64, 11.64, 11.95, 11.95, 12.36, 12.46, 12.56,
# 			12.67, 12.98, 13.29, 13.7, 13.7]

# fgsm_lstm = [5.73, 8.54, 10.19, 11.59, 13.12, 14.78, 42.04, 46.5, 51.97, 54.27,
# 			 56.43, 58.47, 58.34, 60.51, 63.57, 64.84, 65.22, 66.24, 67.13, 67.64,
# 			 67.13, 67.77, 68.03, 68.79, 69.17]

# bim_dnn = [7.85, 31.88, 35.37, 38.36, 41.34, 43.84, 47.2, 50.56, 53.18, 55.29,
# 		   57.04, 60.77, 62.64, 65.5, 66.63, 68.99, 70.24, 71.23, 73.47, 74.22,
# 		   75.22, 76.46, 76.59, 76.84, 77.96]

# bim_cnn = [6.18, 7.21, 7.42, 8.24, 8.55, 8.96, 9.47, 9.99, 10.92, 11.12,
# 		   11.74, 12.36, 13.49, 13.49, 13.7, 14.01, 14.11, 14.73, 14.73, 14.93,
# 		   14.83, 14.83, 14.83, 15.04, 15.55]

# bim_lstm = [10.19, 11.97, 12.36, 15.41, 18.47, 22.17, 51.34, 56.05, 60.76, 64.33,
# 			68.15, 71.21, 74.65, 76.43, 78.73, 80.0, 81.66, 82.55, 84.59, 85.1,
# 			85.86, 86.88, 87.9, 88.28, 89.43]

# mim_dnn = [8.09, 33.0, 35.87, 38.98, 42.43, 45.7, 50.06, 53.92, 56.91, 60.02,
# 		   61.64, 64.26, 67.25, 71.23, 72.48, 75.84, 78.46, 79.95, 81.82, 82.32,
# 		   83.94, 84.81, 88.04, 88.67, 89.66]

# mim_cnn = [6.18, 7.21, 7.42, 8.34, 8.65, 9.06, 9.37, 9.99, 10.4, 11.23,
# 		   12.15, 12.67, 13.59, 13.8, 14.01, 14.11, 14.21, 14.42, 14.83, 14.93,
# 		   15.14, 15.14, 15.76, 16.68, 17.1]

# mim_lstm = [10.06, 11.85, 12.61, 15.41, 19.11, 23.31, 30.06, 57.45, 62.93, 64.2,
# 			69.3, 72.23, 75.54, 76.43, 79.87, 81.66, 82.68, 84.33, 85.22, 87.39,
# 			88.54, 89.3, 90.32, 91.46, 90.57]



# plt.xlabel("EPS of BIM")
# plt.ylabel("Success Rate(%)")
# plt.ylim(0, 100)
# plt.plot(EPS, bim_dnn, marker='o', linewidth=2, color="y", label="DNN")
# plt.plot(EPS, bim_cnn, marker='o', linewidth=2, color="firebrick", label="CNN")
# plt.plot(EPS, bim_lstm, marker='o', linewidth=2, color="orange", label="LSTM")

# fgsm_cnn = [3.4, 3.6, 4.22, 4.84, 5.15, 5.56, 5.77, 5.77, 6.18, 7.0,
# 			7.21, 10.61, 10.92, 11.64, 11.64, 11.95, 11.95, 12.36, 12.46, 12.56,
# 			12.67, 12.98, 13.29, 13.7, 13.7, 13.7, 14.11, 14.01, 14.11, 14.73,
# 			15.76, 16.79, 17.92, 19.46, 20.6]

# bim_cnn = [6.18, 7.21, 7.42, 8.24, 8.55, 8.96, 9.47, 9.99, 10.92, 11.12,
# 		   11.74, 12.36, 13.49, 13.49, 13.7, 14.01, 14.11, 14.73, 14.73, 14.93,
# 		   14.83, 14.83, 14.83, 15.04, 15.55, 15.76, 15.96, 16.07, 16.48, 16.89,
# 		   17.4, 17.2, 17.3, 17.2, 17.3]

# mim_cnn = [6.18, 7.21, 7.42, 8.34, 8.65, 9.06, 9.37, 9.99, 10.4, 11.23, 
# 		   12.15, 12.67, 13.59, 13.8, 14.01, 14.11, 14.21, 14.42, 14.83, 14.93,
# 		   15.14, 15.14, 15.76, 16.68, 17.1, 17.2, 18.43, 38.11, 40.68, 42.95,
# 		   44.59, 43.36, 42.43, 42.95, 43.56]

# plt.xlabel("EPS of Methods")
# plt.ylabel("Success Rate(%)")
# plt.ylim(0, 50)
# plt.plot(EPS, fgsm_cnn, marker='o', linewidth=2, color="lightcoral", label="FGSM")
# plt.plot(EPS, bim_cnn, marker='o', linewidth=2, color="tomato", label="BIM")
# plt.plot(EPS, mim_cnn, marker='o', linewidth=2, color="coral", label="MIM")

# methods = ["FGSM", "BIM", "MIM", "CW"]
# acc_dnn = [24.86, 72.71, 83.57, 60.86]
# acc_cnn = [42.43, 84.57, 88.29, 87.57]
# acc_lstm = [79.86, 91.00, 97.43, 28.86]
# acc_dnn = [45.45, 77.96, 89.66, 59.53]
# acc_cnn = [14.73, 16.89, 42.95, 15.24]
# acc_lstm = [69.17, 89.43, 90.57, 16.82]

# models = ["KNN", "Random\nForest", "SVM", "DNN", "CNN", "LSTM"]
# rate = []

# models = ["MIM\non DNN"," MIM\non LSTM"]
# m_0 = [89.66, 90.57]
# m_1 = [88.54, 85.1]
# m_2 = [54.55, 28.03]

models = ["DNN", "CNN", "LSTM"]

# mim_ori = [89.66, 42.95, 90.57]
# mim_sub = [92.45, 46.28, 97.98]
# cw_ori = [59.53, 15.24, 16.82]
# cw_sub = [60.48, 19.56, 45.63]

ori = [94.77, 90.02, 97.68]
sub = [92.74, 86.34, 91.53]

x = np.arange(len(models))
width = 0.15

fig, ax = plt.subplots()
# ax.bar(x, rate, width)
ax.bar(x-0.5*width, ori, width, label="Ori_Model")
ax.bar(x+0.5*width, sub, width, label="Sub_Model")
ax.set_ylabel("Accuracy(%)")
ax.set_xticks(x)
ax.set_xticklabels(models)

plt.legend()
plt.savefig("/root/WorkPlace/graph/adv_acc_7.png")
plt.close()